<!DOCTYPE html>
<html lang="en" ng-app="BreakingTheRules">
<head>
	<meta charset="UTF-8">
	<title>BreakingTheRules</title>
	
	<link rel="stylesheet" href="./styles/ext/bootstrap.min.css"></link>
	<script src="./scripts/ext/jquery.min.js"></script>
	<script src="./scripts/ext/angular.min.js"></script>
	<script src="./scripts/ext/bootstrap.min.js"></script>
	<script src="./scripts/index.js"></script>
	<link rel="stylesheet" href="./styles/index.css"></link>
</head>
<body ng-controller="GlobalController as globalCtrl">
	<div class="container">

		<h1>BreakingTheRules</h1>


		<!-- The rules made so far -->
		<h2>Rules</h2> 
		<p>The rules are ordered bottom-up: the bottom rule is the base rule, and the new rules are placed on top of it, until the base rule will be no longer needed.</p>
		<table ng-controller="RulesController as rulesCtrl" class="table">
			<tr>
				<th></th>
				<th ng-repeat="att in globalCtrl.attributes">{{ att | capitalize }}</th>
			</tr>
			<tr ng-repeat="rule in rulesCtrl.rules">
				<td> {{ rule.id }} </td>
				<td ng-repeat="attribute in rule.attributes"> {{ attribute.str }} </td>
			</tr>
		</table>

		<!-- The hits under the current filter -->
		<div ng-controller="HitsTableController as hitsCtrl">
		<h2>Hits ({{ hitsCtrl.numOfHits }})</h2>
			<table class="table HitsTable">
				<tr>
					<th></th>
					<th ng-repeat="att in globalCtrl.attributes">{{ att | capitalize }}</th>
				</tr>
				<tr ng-controller="FilterController as filterCtrl">
					<td> <button class="btn" ng-click="filterCtrl.setFilter()">Filter</button> </td>
					<td ng-repeat="attribute in filterCtrl.currentFilter.attributes">
						<input type="text" 
							class="form-control" 
							ng-model="attribute.field" 
							placeholder="Any" 
							on-enter-key="filterCtrl.setFilter()" />
					</td>
				</tr>
				<tr ng-repeat="hit in hitsCtrl.allHits">
					<td> {{ hit.id }} </td>
					<td ng-repeat="attribute in hit.attributes"> {{ attribute.str }} </td>
				</tr>
			</table>
			<page-turner 
				nav-size="hitsCtrl.NAV_SIZE" 
				current-page="hitsCtrl.page"
				num-of-pages="hitsCtrl.numOfPages"></page-turner>
		</div>


		<!-- Suggestions for future rules -->
		<h2>Suggestions</h2>
		<table ng-controller="SuggestionController as sugCtrl" class="table SuggestionTable">
				<tr>
					<th ng-repeat="attSuggestion in sugCtrl.allSuggestions">
						{{ attSuggestion.type }}
					</th>
				</tr>
				<tr>
					<td ng-repeat="attSuggestions in sugCtrl.allSuggestions">
						<ul>
							<li ng-repeat="sug in attSuggestions.suggestions">{{ sug.attribute.str }} <span>({{ sug.score * 100| number :1 }}%)</span></li>
						</ul>
					</td>
				</tr>	
			</tbody>
		</table>

	</div>
</body>
</html>